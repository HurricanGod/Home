## 事务实现



+ `mysql`中**原子性、一致性、持久性**通过数据库中的`redo log `和`undo log`来完成；`redo log `为重做日志，**用来保证事务的原子性和持久性** ，**`undo log` 用来保证事务的一致性**
  + `redo log `——恢复提交事务修改的页操作，通常对应**物理日志**，记录的是**页的物理修改操作**
  + `undo log`——回滚行记录到某个特定的版本，是**逻辑日志**，根据每行记录进行记录，用于帮助**事务回滚**及**MVCC功能**



-----

### redo

+ 用来实现事务的持久性，即事务**ACID**中的D，由两部分组成：
  + 内存中的重做日志缓冲（**redo log buffer**）——**易失的**
  + 重做日志文件（**redo log file**）—— **持久的**
+ 当事务提交时，必须先将该事务的所有日志写入到重做日志文件进行持久化，写完commit操作才算完成
+ `redo log`基本是顺序写的，数据库运行时不需要对**redo log**的文件进行读取操作
+ 每次将`redo log`缓冲写入重做日志文件后`InnoDB存储引擎`都会调用一次`fsync`操作，磁盘的性能决定事务提交的性能





### undo

+ `undo`存放在数据库内存中的特殊段——undo段，是逻辑日志，只是将数据库逻辑地恢复到原来的样子，因为可能存在多个并发事务，将事务回滚到最开始的版本会影响其它事务正在进行的工作
+ ​